# Hata ayıklama ve güvenlik protokol ayarları
$ErrorActionPreference = "Stop"
[Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12

$DownloadURL = 'https://raw.githubusercontent.com/emreuls7/mr.winls/pasha/pasha_menu.cmd'
$DownloadPath = 'C:\Windows\Temp\pasha_menu.cmd'

try {
    # Dosyayı indirin
    $response = Invoke-WebRequest -Uri $DownloadURL -UseBasicParsing
    # İçeriği geçici bir dosyaya yazın
    $response.Content | Set-Content -Path $DownloadPath
} catch {
    Write-Error "Dosyayı indirme veya kaydetme başarısız oldu: $_"
    exit 1
}

try {
    # CMD dosyasını çalıştırın
    Start-Process -FilePath cmd.exe -ArgumentList "/c `"$DownloadPath`"" -NoNewWindow -Wait
} catch {
    Write-Error "Dosyayı çalıştırma başarısız oldu: $_"
} finally {
    try {
        # CMD dosyasını kaldırın
        Remove-Item -Path $DownloadPath -Force
    } catch {
        Write-Error "Dosyayı silme başarısız oldu: $_"
    }
}
