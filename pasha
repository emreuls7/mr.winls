$ErrorActionPreference = "Stop"
[Net.ServicePointManager]::SecurityProtocol = [Net.ServicePointManager]::SecurityProtocol -bor [Net.SecurityProtocolType]::Tls12

$DownloadURL = 'https://raw.githubusercontent.com/emreuls7/mr.winls/pasha/pasha_menu.cmd'
$DownloadPath = 'C:\Windows\Temp\pasha_menu.cmd'

try {
    # Download the CMD file
    $response = Invoke-WebRequest -Uri $DownloadURL -UseBasicParsing
} catch {
    Write-Error "Failed to download the file: $_"
    exit 1
}

# Save the file content
Set-Content -Path $DownloadPath -Value $response.Content

try {
    # Execute the CMD file
    Start-Process -FilePath cmd.exe -ArgumentList "/c $DownloadPath" -NoNewWindow -Wait
} catch {
    Write-Error "Failed to execute the file: $_"
} finally {
    # Remove the CMD file
    Remove-Item -Path $DownloadPath -Force
}

